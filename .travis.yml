sudo: false
language: php
notifications:
  slack:
    secure: R56fO2Xle04yjzjC2aYI3ZjMtNWOzIrG0eizl3LxLCekGfXoWRl67+34JoltWNMpm4fo06eDoy4OEBzhCeABTEerQsA7nz267xv6L7g8F4i3npd8xQ1gxpjPdIm1XXBcv7HYp3GAHgarw/Nw3FpiDHUxSR9hjpHbE9B6a7H4tz2XkKTO1/BR9sCuzeZskAQawV6eVodlsd/GHRzPJaXqaDK7I0Wm0y11varO4jKWM/l3qOsqE9+B2ItChhbJk69QPGb7bZ2oY0GNpktNWeClacN7M/WNYMXijMqQlLIF9QEdTN6JGg7yzYifZiX01F2+2Ub98TYO8FiKKddb6CEzQyk3fdj3qkKP3yrmEpYc4T5OsuTgfi+Uvl5YQFyTQD9riri0eELdonbpJ4gM4dnQ8KbpOWYedF49UzQVGdz+B4DyTkkaVRvRwIljJjhfzJXcu/UTaTg/fmkiQUs47cS6ZLAlhT/EXsM4Ox7pL2EmzrEs4JxV/HTzoF1d5OBE2ID42H2V6GY9LwuBwDt4REcTErzdOApmpE0jPOPE+9zQu5XzQBrN+WwS/4JqGwd/prU92Z55ImiMi4/hZGDdsZUHnEWJfF3PIytVHg0PNDEy622Q4ObgGJbaZBOYjk/RtS0UMncr8zhwTh06+AyGYZ/q7yrYgPWB6xi2w9SWUi8bpjM=
php:
- 7
- 5.6
- 5.5
- 5.4
env:
- WP_PROJECT_TYPE=plugin WP_VERSION=latest WP_MULTISITE=0 WP_TEST_URL=http://localhost:12000
  WP_TEST_USER=test WP_TEST_USER_PASS=test
matrix:
  allow_failures:
  - php: 7
matrix:
  fast_finish: true
  include:
    # Run PHPCS against WPCS. I just picked to run it against 5.5.
    - php: 5.5
      env: PHPCS_BRANCH=master SNIFF=1
    # Run against PHPCS 3.0. I just picked to run it against 5.6.
    - php: 5.6
      env: PHPCS_BRANCH=3.0
    # Run against HHVM and PHP nightly.
    - php: 7
      env: PHPCS_BRANCH=master
  allow_failures:
    # Allow failures for unstable builds.
    - php: 7
    - env: PHPCS_BRANCH=3.0
before_script:
- export PHPCS_DIR=/tmp/phpcs
- export PHPCS_BIN=$(if [[ $PHPCS_BRANCH == 3.0 ]]; then echo $PHPCS_DIR/bin/phpcs; else echo $PHPCS_DIR/scripts/phpcs; fi)
- mkdir -p $PHPCS_DIR && git clone --depth 1 https://github.com/squizlabs/PHP_CodeSniffer.git -b $PHPCS_BRANCH $PHPCS_DIR
- $PHPCS_BIN --config-set installed_paths $(pwd)
script:
- phpunit --filter WordPress /tmp/phpcs/tests/AllTests.php
- if [[ "$SNIFF" == "1" ]]; then $PHPCS_DIR/scripts/phpcs -p -s -v -n . --standard=./bin/phpcs.xml --extensions=php; fi
